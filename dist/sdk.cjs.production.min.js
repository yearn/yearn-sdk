"use strict";function t(t){return t&&"object"==typeof t&&"default"in t?t.default:t}Object.defineProperty(exports,"__esModule",{value:!0}),require("cross-fetch/polyfill");var e=t(require("events")),r=require("@ethersproject/contracts"),n=require("@ethersproject/bignumber/lib/bignumber"),s=require("@ethersproject/bignumber"),a=require("@ethersproject/address"),i=t(require("object-hash"));function o(t,e,r,n,s,a,i){try{var o=t[a](i),u=o.value}catch(t){return void r(t)}o.done?e(u):Promise.resolve(u).then(n,s)}function u(t){return function(){var e=this,r=arguments;return new Promise((function(n,s){var a=t.apply(e,r);function i(t){o(a,n,s,i,u,"next",t)}function u(t){o(a,n,s,i,u,"throw",t)}i(void 0)}))}}function c(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function p(t,e,r){return e&&c(t.prototype,e),r&&c(t,r),t}function f(){return(f=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t}).apply(this,arguments)}function h(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,l(t,e)}function d(t){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function v(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function y(t,e,r){return(y=v()?Reflect.construct:function(t,e,r){var n=[null];n.push.apply(n,e);var s=new(Function.bind.apply(t,n));return r&&l(s,r.prototype),s}).apply(null,arguments)}function m(t){var e="function"==typeof Map?new Map:void 0;return(m=function(t){if(null===t||-1===Function.toString.call(t).indexOf("[native code]"))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return y(t,arguments,d(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),l(r,t)})(t)}function w(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function g(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function b(t,e){var r;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return g(t,void 0);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?g(t,void 0):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(r=t[Symbol.iterator]()).next.bind(r)}var x,k=(function(t){var e=function(t){var e=Object.prototype,r=e.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},s=n.iterator||"@@iterator",a=n.asyncIterator||"@@asyncIterator",i=n.toStringTag||"@@toStringTag";function o(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{o({},"")}catch(t){o=function(t,e,r){return t[e]=r}}function u(t,e,r,n){var s=Object.create((e&&e.prototype instanceof f?e:f).prototype),a=new P(n||[]);return s._invoke=function(t,e,r){var n="suspendedStart";return function(s,a){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===s)throw a;return{value:void 0,done:!0}}for(r.method=s,r.arg=a;;){var i=r.delegate;if(i){var o=b(i,r);if(o){if(o===p)continue;return o}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=c(t,e,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===p)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}(t,r,a),s}function c(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=u;var p={};function f(){}function h(){}function d(){}var l={};l[s]=function(){return this};var v=Object.getPrototypeOf,y=v&&v(v(O([])));y&&y!==e&&r.call(y,s)&&(l=y);var m=d.prototype=f.prototype=Object.create(l);function w(t){["next","throw","return"].forEach((function(e){o(t,e,(function(t){return this._invoke(e,t)}))}))}function g(t,e){var n;this._invoke=function(s,a){function i(){return new e((function(n,i){!function n(s,a,i,o){var u=c(t[s],t,a);if("throw"!==u.type){var p=u.arg,f=p.value;return f&&"object"==typeof f&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){n("next",t,i,o)}),(function(t){n("throw",t,i,o)})):e.resolve(f).then((function(t){p.value=t,i(p)}),(function(t){return n("throw",t,i,o)}))}o(u.arg)}(s,a,n,i)}))}return n=n?n.then(i,i):i()}}function b(t,e){var r=t.iterator[e.method];if(void 0===r){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,b(t,e),"throw"===e.method))return p;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return p}var n=c(r,t.iterator,e.arg);if("throw"===n.type)return e.method="throw",e.arg=n.arg,e.delegate=null,p;var s=n.arg;return s?s.done?(e[t.resultName]=s.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,p):s:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,p)}function x(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function k(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(x,this),this.reset(!0)}function O(t){if(t){var e=t[s];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,a=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return a.next=a}}return{next:j}}function j(){return{value:void 0,done:!0}}return h.prototype=m.constructor=d,d.constructor=h,h.displayName=o(d,i,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===h||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,o(t,i,"GeneratorFunction")),t.prototype=Object.create(m),t},t.awrap=function(t){return{__await:t}},w(g.prototype),g.prototype[a]=function(){return this},t.AsyncIterator=g,t.async=function(e,r,n,s,a){void 0===a&&(a=Promise);var i=new g(u(e,r,n,s),a);return t.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},w(m),o(m,i,"Generator"),m[s]=function(){return this},m.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var r in t)e.push(r);return e.reverse(),function r(){for(;e.length;){var n=e.pop();if(n in t)return r.value=n,r.done=!1,r}return r.done=!0,r}},t.values=O,P.prototype={constructor:P,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(k),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return i.type="throw",i.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var s=this.tryEntries.length-1;s>=0;--s){var a=this.tryEntries[s],i=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var o=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(o&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(o){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var s=this.tryEntries[n];if(s.tryLoc<=this.prev&&r.call(s,"finallyLoc")&&this.prev<s.finallyLoc){var a=s;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,p):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),p},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),k(r),p}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var s=n.arg;k(r)}return s}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:O(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),p}},t}(t.exports);try{regeneratorRuntime=e}catch(t){Function("r","regeneratorRuntime = r")(e)}}(x={exports:{}}),x.exports),P=function(t){function e(){return t.apply(this,arguments)||this}return h(e,t),e}(m(Error)),O=function(t,r){var n=this;this.chainId=t,this.ctx=r,this.events=new e;for(var s,a=function(){var t=s.value,e=Reflect.get(n,t),r=[n.constructor.name,e.name].join(".");Reflect.set(n,t,new Proxy(e,{apply:function(t,s,a){try{var i=t.apply(s,a);return i&&i instanceof Promise?i.then((function(t){return n.events.emit(e.name,t),t})).catch((function(t){throw new P(r+": "+t.message)})):n.events.emit(e.name,i),i}catch(t){throw new P(r+": "+t.message)}}}))},i=b(Object.getOwnPropertyNames(Object.getPrototypeOf(this)));!(s=i()).done;)a()},j=function(t){function e(e,r,n){var s;(s=t.call(this,r,n)||this).yearn=e;for(var a,i=function(){var t=a.value,e=Reflect.get(w(s),t),r=[s.constructor.name,e.name].join(".");Reflect.set(w(s),t,new Proxy(e,{apply:function(t,e,n){var a,i=(a=s.ctx.cache).get.apply(a,[r].concat(n));if(i)return console.debug("[SDK] Cache hit "+r),i;console.debug("[SDK] Cache miss "+r);var o,u=t.apply(e,n);return u&&u instanceof Promise?u.then((function(t){var e;return(e=s.ctx.cache).set.apply(e,[t,r].concat(n)),t})):(o=s.ctx.cache).set.apply(o,[u,r].concat(n)),u}}))},o=b(Object.getOwnPropertyNames(Object.getPrototypeOf(w(s))));!(a=o()).done;)i();return s}return h(e,t),e}(O),A=function(t){function e(e,n,s){var a;return(a=t.call(this,n,s)||this).address=e,a.contract=new r.Contract(a.address,a.constructor.abi,s.provider),a}return h(e,t),e}(O);function E(t){return t.map((function(t){return function t(e){if("object"!=typeof e)return e;var r=Object.keys(e).filter((function(t){return isNaN(Number(t))}));if(0===r.length)return E(e);var s={};return r.forEach((function(r){var a=e[r];s[r]="object"!=typeof a||n.isBigNumberish(a)?a:t(a)})),s}(t)}))}A.abi=[];var L=function(t){function e(r,n){var s;return t.call(this,null!=(s=n.address("registryV2Adapter"))?s:e.addressByChain(r),r,n)||this}h(e,t),e.addressByChain=function(t){switch(t){case 1:case 250:return"0xE75E51566C5761896528B4698a88C92A54B3C954"}throw new TypeError("RegistryV2Adapter does not have an address for chainId "+t)};var r=e.prototype;return r.assetsStatic=function(){var t=u(k.mark((function t(e){return k.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e){t.next=4;break}return t.next=3,this.contract["assetsStatic(address[])"](e).then(E);case 3:return t.abrupt("return",t.sent);case 4:return t.next=6,this.contract["assetsStatic()"]().then(E);case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),r.assetsDynamic=function(){var t=u(k.mark((function t(e){return k.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e){t.next=4;break}return t.next=3,this.contract["assetsDynamic(address[])"](e).then(E);case 3:return t.abrupt("return",t.sent);case 4:return t.next=6,this.contract["assetsDynamic()"]().then(E);case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),r.positionsOf=function(){var t=u(k.mark((function t(e,r){return k.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!r){t.next=4;break}return t.next=3,this.contract["assetsPositionsOf(address,address[])"](e,r).then(E);case 3:return t.abrupt("return",t.sent);case 4:return t.next=6,this.contract["assetsPositionsOf(address)"](e).then(E);case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}}),t,this)})));return function(e,r){return t.apply(this,arguments)}}(),r.tokens=function(){var t=u(k.mark((function t(){return k.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.contract.tokens().then(E);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),e}(A);L.abi=["function assetsStatic() public view returns (tuple(address id, string typeId, string name, string version,tuple(address id, string name, string symbol, uint256 decimals) token)[] memory)","function assetsStatic(address[] memory) public view returns (tuple(address id, string typeId, string name, string version,tuple(address id, string name, string symbol, uint256 decimals) token)[] memory)","function assetsDynamic() public view returns (tuple(address id, string typeId, address tokenId,tuple(uint256 amount, uint256 amountUsdc) underlyingTokenBalance,tuple(string symbol, uint256 pricePerShare, bool migrationAvailable, address latestVaultAddress, uint256 depositLimit, bool emergencyShutdown) metadata)[] memory)","function assetsDynamic(address[] memory) public view returns (tuple(address id, string typeId, address tokenId,tuple(uint256 amount, uint256 amountUsdc) underlyingTokenBalance,tuple(string symbol, uint256 pricePerShare, bool migrationAvailable, address latestVaultAddress, uint256 depositLimit, bool emergencyShutdown) metadata)[] memory)","function assetsPositionsOf(address) public view returns (tuple(address assetId, address tokenId, string typeId, uint256 balance,tuple(uint256 amount, uint256 amountUsdc) underlyingTokenBalance,tuple(address owner, address spender, uint256 amount)[] tokenAllowances,tuple(address owner, address spender, uint256 amount)[] assetAllowances)[] memory)","function assetsPositionsOf(address, address[] memory) public view returns (tuple(address assetId, address tokenId, string typeId, uint256 balance,tuple(uint256 amount, uint256 amountUsdc) underlyingTokenBalance,tuple(address owner, address spender, uint256 amount)[] tokenAllowances,tuple(address owner, address spender, uint256 amount)[] assetAllowances)[] memory)","function tokens() public view returns (tuple(address id, string name, string symbol, uint256 decimals)[] memory)"];var B=function(t){function e(r,n){var s;return t.call(this,null!=(s=n.address("lens"))?s:e.addressByChain(r),r,n)||this}h(e,t),e.addressByChain=function(t){switch(t){case 1:case 250:return"0xFa58130BE296EDFA23C42a1d15549fA91449F979"}throw new TypeError("Lens does not have an address for chainId "+t)};var r=e.prototype;return r.getRegistries=function(){var t=u(k.mark((function t(){return k.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.contract.getRegistries();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),r.getAssets=function(){var t=u(k.mark((function t(){return k.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.contract.getAssets().then(E);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),r.getAssetsFromAdapter=function(){var t=u(k.mark((function t(e){return k.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.contract.getAssetsFromAdapter(e).then(E);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),r.getPositions=function(){var t=u(k.mark((function t(e){return k.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.contract.getPositionsOf(e).then(E);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),p(e,[{key:"adapters",get:function(){switch(this.chainId){case 1:case 250:case 1337:return{vaults:{v2:new L(this.chainId,this.ctx)}}}throw new TypeError("No adapter exist for chainId "+this.chainId)}}]),e}(A);B.abi=["function getRegistries() external view returns (address[] memory)","function getAssets() external view returns (tuple(string name, address id, string version)[] memory)","function getAssetsFromAdapter(address) external view returns (tuple(string name, address id, string version)[] memory)","function getPositionsOf(address) external view returns (tuple(address asset, uint256 depositedBalance, uint256 tokenBalance, uint256 tokenAllowance)[] memory)","function getPositionsOf(address, address) external view returns (tuple(address asset, uint256 depositedBalance, uint256 tokenBalance, uint256 tokenAllowance)[] memory)"];var I=function(t){function e(r,n){var s;return t.call(this,null!=(s=n.address("oracle"))?s:e.addressByChain(r),r,n)||this}h(e,t),e.addressByChain=function(t){switch(t){case 1:return"0xd3ca98D986Be88b72Ff95fc2eC976a5E6339150d";case 250:return"0xae813841436fe29b95a14AC701AFb1502C4CB789"}throw new TypeError("Oracle does not have an address for chainId "+t)};var r=e.prototype;return r.getCalculations=function(){var t=u(k.mark((function t(){return k.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.contract.calculations();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),r.getPriceUsdc=function(){var t=u(k.mark((function t(e){return k.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.contract.getPriceUsdcRecommended(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),r.getUsdcAddress=function(){var t=u(k.mark((function t(){return k.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.contract.usdcAddress();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),r.isCurveLpToken=function(){var t=u(k.mark((function t(e){return k.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.contract.isCurveLpToken(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),r.getCurvePriceUsdc=function(){var t=u(k.mark((function t(e){return k.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.contract.getCurvePriceUsdc(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),r.getBasePrice=function(){var t=u(k.mark((function t(e){return k.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.contract.getBasePrice(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),r.getVirtualPrice=function(){var t=u(k.mark((function t(e){return k.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.contract.getVirtualPrice(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),r.getFirstUnderlyingCoinFromPool=function(){var t=u(k.mark((function t(e){return k.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.contract.getFirstUnderlyingCoinFromPool(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),r.getCurveRegistryAddress=function(){var t=u(k.mark((function t(){return k.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.contract.usdcAddress();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),r.isIronBankMarket=function(){var t=u(k.mark((function t(e){return k.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.contract.isIronBankMarket(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),r.getIronBankMarketPriceUsdc=function(){var t=u(k.mark((function t(e){return k.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.contract.getIronBankMarketPriceUsdc(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),r.getIronBankMarkets=function(){var t=u(k.mark((function t(){return k.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.contract.getIronBankMarkets();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),r.isLpToken=function(){var t=u(k.mark((function t(e){return k.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.contract.isLpToken(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),r.getPriceFromRouter=function(){var t=u(k.mark((function t(e,r){return k.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.contract.getPriceFromRouter(e,r);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)})));return function(e,r){return t.apply(this,arguments)}}(),r.getPriceFromRouterUsdc=function(){var t=u(k.mark((function t(e){return k.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.contract.getPriceFromRouterUsdc(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),r.getLpTokenTotalLiquidityUsdc=function(){var t=u(k.mark((function t(e){return k.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.contract.getLpTokenTotalLiquidityUsdc(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),r.getLpTokenPriceUsdc=function(){var t=u(k.mark((function t(e){return k.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.contract.getLpTokenPriceUsdc(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),e}(A);function S(t){return T.apply(this,arguments)}function T(){return(T=u(k.mark((function t(e){return k.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(200===e.status){t.next=2;break}throw new P("HTTP to "+e.url+" request failed (status "+e.status+" "+e.statusText+")");case 2:return t.abrupt("return",e);case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function U(t){return s.BigNumber.from(Math.floor(1e6*Number(t)))}I.abi=["function calculations() external view returns (address[] memory)","function getPriceUsdcRecommended(address) public view returns (uint256)","function usdcAddress() public view returns (address)","function isCurveLpToken(address) public view returns (bool)","function getCurvePriceUsdc(address) public view returns (uint256)","function getBasePrice(address) public view returns (uint256)","function getVirtualPrice(address) public view returns (uint256)","function getFirstUnderlyingCoinFromPool(address) public view returns (address)","function curveRegistryAddress() public view returns (address)","function isIronBankMarket(address) public view returns (bool)","function getIronBankMarketPriceUsdc(address) public view returns (uint256)","function getIronBankMarkets() public view returns (address[] memory)","function isLpToken(address) public view returns (bool)","function getPriceFromRouter(address, address) public view returns (uint256)","function getPriceFromRouterUsdc(address) public view returns (uint256)","function getLpTokenTotalLiquidityUsdc(address) public view returns (uint256)","function getLpTokenPriceUsdc(address) public view returns (uint256)"];var R=function(t){function e(){return t.apply(this,arguments)||this}h(e,t);var r=e.prototype;return r.supportedTokens=function(){var t=u(k.mark((function t(){var e;return k.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=new URLSearchParams({api_key:this.ctx.zapper}),t.next=4,fetch("https://api.zapper.fi/v1/prices?"+e).then(S).then((function(t){return t.json()}));case 4:return t.abrupt("return",t.sent.map((function(t){return{id:t.address,name:t.symbol,symbol:t.symbol,decimals:s.BigNumber.from(t.decimals),price:U(t.price),supported:{zapper:!0}}})));case 6:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),r.balances=function(){var t=u(k.mark((function t(e){var r,n;return k.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=new URLSearchParams({"addresses[]":Array.isArray(e)?e.join():e,api_key:this.ctx.zapper}),t.next=4,fetch("https://api.zapper.fi/v1/balances/tokens?"+r).then(S).then((function(t){return t.json()}));case 4:if(n=t.sent,Object.keys(n).forEach((function(t){var e=n[t];delete n[t],n[a.getAddress(t)]=e.map((function(t){var e="0x0000000000000000000000000000000000000000"===t.address?"0xEeeeeEeeeEeEeeEeEeEeeEEEeeeeEeeeeeeeEEeE":a.getAddress(String(t.address));return{address:e,token:{id:e,name:t.symbol,symbol:t.symbol,decimals:s.BigNumber.from(t.decimals)},balance:s.BigNumber.from(t.balanceRaw),balanceUsdc:U(t.balanceUSD),price:U(t.price)}}))})),Array.isArray(e)){t.next=8;break}return t.abrupt("return",n[e]);case 8:return t.abrupt("return",n);case 9:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),r.gas=function(){var t=u(k.mark((function t(){var e;return k.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=new URLSearchParams({api_key:this.ctx.zapper}),t.next=4,fetch("https://api.zapper.fi/v1/gas-price?"+e).then(S).then((function(t){return t.json()}));case 4:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),e}(O),C=function(t){function e(){return t.apply(this,arguments)||this}return h(e,t),e.prototype.get=function(){var t=u(k.mark((function t(e){var r;return k.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=3,fetch("https://vaults.finance/all").then(S).then((function(t){return t.json()}));case 3:if(r=t.sent.find((function(t){return t.address===e}))){t.next=7;break}return t.abrupt("return");case 7:return t.abrupt("return",r.apy);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}(O),F=function(t){function e(){return t.apply(this,arguments)||this}h(e,t);var r=e.prototype;return r.get=function(){var t=u(k.mark((function t(e){var r;return k.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=Object.values(this.yearn.services.lens.adapters.vaults),t.next=3,Promise.all(r.map(function(){var t=u(k.mark((function t(r){var n,s,a,i,o,u;return k.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.assetsStatic(e);case 2:return n=t.sent,t.next=5,r.assetsDynamic(e);case 5:for(s=t.sent,a=new Array,i=function(){var t=u.value,e=s.find((function(e){return t.id===e.id}));if(!e)throw new P("Dynamic asset does not exist for "+t.id);a.push(f({},t,e))},o=b(n);!(u=o()).done;)i();return t.abrupt("return",a);case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())).then((function(t){return t.flat()}));case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),r.positionsOf=function(){var t=u(k.mark((function t(e,r){var n;return k.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=Object.values(this.yearn.services.lens.adapters.vaults),t.next=3,Promise.all(n.map((function(t){return t.positionsOf(e,r)}))).then((function(t){return t.flat()}));case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t,this)})));return function(e,r){return t.apply(this,arguments)}}(),r.apy=function(){var t=u(k.mark((function t(e){return k.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.yearn.services.apy.get(e));case 1:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),e}(j),_=function(t){function e(){return t.apply(this,arguments)||this}h(e,t);var r=e.prototype;return r.priceUsdc=function(){var t=u(k.mark((function t(e){return k.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.yearn.services.oracle.getPriceUsdc(e));case 1:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),r.price=function(){var t=u(k.mark((function t(e,r){return k.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.yearn.services.oracle.getPriceFromRouter(e,r));case 1:case"end":return t.stop()}}),t,this)})));return function(e,r){return t.apply(this,arguments)}}(),r.balances=function(){var t=u(k.mark((function t(e){return k.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.yearn.services.zapper.balances(e));case 1:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),r.supported=function(){var t=u(k.mark((function t(){var e,r,n=this;return k.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=[],1!==this.chainId&&1337!==this.chainId){t.next=6;break}return t.next=4,this.yearn.services.zapper.supportedTokens();case 4:e.push.apply(e,t.sent);case 6:return r=Object.values(this.yearn.services.lens.adapters.vaults),t.next=9,Promise.all(r.map(function(){var t=u(k.mark((function t(e){return k.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.tokens();case 2:return t.abrupt("return",Promise.all(t.sent.map(function(){var t=u(k.mark((function t(e){return k.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=f,t.t1={},t.t2=e,t.t3={},t.next=6,n.yearn.services.oracle.getPriceUsdc(e.id);case 6:return t.t4=t.sent,t.t5={supported:t.t3,price:t.t4},t.abrupt("return",(0,t.t0)(t.t1,t.t2,t.t5));case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())).then((function(t){return t.flat()}));case 9:return e.push.apply(e,t.sent),t.abrupt("return",e);case 12:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),r.icon=function(t){return this.yearn.services.icons.get(t)},e}(j),N=function(){function t(t){this.cache=Object.assign({},{get:function(){},set:function(){},ttl:Infinity},t)}var e=t.prototype;return e.what=function(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return"yearn_sdk"+i({key:t,args:r})},e.set=function(t,e){for(var r=arguments.length,n=new Array(r>2?r-2:0),s=2;s<r;s++)n[s-2]=arguments[s];var a=this.what.apply(this,[e].concat(n));this.cache.set(a,JSON.stringify({value:t,timestamp:Date.now()}))},e.get=function(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];var s=this.what.apply(this,[t].concat(r)),a=this.cache.get(s);if(a){var i=JSON.parse(a);if(!(Date.now()-i.timestamp>this.cache.ttl))return i.value}},t}(),z=function(){function t(t,e){this.ctx=Object.assign({},t,{zapper:"96e0cc51-a62e-42ca-acee-910ea7d2a241"}),this.cache=new N(e)}return t.prototype.address=function(t){return this.addresses[t]},p(t,[{key:"provider",get:function(){if(this.ctx.provider)return this.ctx.provider;throw new P("provider must not be undefined in Context for this feature to work.")}},{key:"zapper",get:function(){if(this.ctx.zapper)return this.ctx.zapper;throw new P("zapper must not be undefined in Context for this feature to work.")}},{key:"etherscan",get:function(){if(this.ctx.etherscan)return this.ctx.etherscan;throw new P("etherscan must not be undefined in Context for this feature to work.")}},{key:"addresses",get:function(){return this.ctx.addresses?this.ctx.addresses:{}}}]),t}(),M=function(t){return"https://raw.githack.com/yearn/yearn-assets/master/icons/tokens/"+t+"/logo-128.png"},D=function(t){return"https://raw.githack.com/trustwallet/assets/master/blockchains/ethereum/assets/"+t+"/logo.png"},q=function(t){function e(e,r){var n;return(n=t.call(this,e,r)||this).supported=new Map,n.ready=n.initialize(),n}h(e,t);var r=e.prototype;return r.initialize=function(){var t=u(k.mark((function t(){var e,r,n,s,a,i,o,u;return k.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("https://api.github.com/repos/yearn/yearn-assets/contents/icons/tokens").then(S).then((function(t){return t.json()}));case 2:return e=t.sent,t.next=5,fetch("https://raw.githack.com/trustwallet/assets/master/blockchains/ethereum/tokenlist.json").then(S).then((function(t){return t.json()})).then((function(t){return t.tokens}));case 5:for(r=t.sent,this.supported=new Map,n=b(r);!(s=n()).done;)this.supported.set((a=s.value).address,D(a.address));for(i=b(e);!(o=i()).done;)this.supported.set((u=o.value).address,M(u.address));case 9:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),r.get=function(t){var e=this;return Array.isArray(t)?Object.fromEntries(t.map((function(t){return[t,e.supported.get(t)]}))):this.supported.get(t)},e}(O);exports.ApyService=C,exports.LensService=B,exports.OracleService=I,exports.TokenReader=_,exports.VaultReader=F,exports.Yearn=function(t,e,r){var n=new z(e,r);this.services={lens:new B(t,n),oracle:new I(t,n),zapper:new R(t,n),icons:new q(t,n),apy:new C(t,n)},this.vaults=new F(this,t,n),this.tokens=new _(this,t,n)},exports.ZapperService=R;
//# sourceMappingURL=sdk.cjs.production.min.js.map
